VENTOS_SUMO -- this readme file is outdated!
===========

This git repository contains a modified version of SUMO project. SUMO has its own repository at the following address:

        https://svn.code.sf.net/p/sumo/code/trunk/sumo

I will take care of updating the git repository wih the latest changes in the original SUMO SVN. In the following, we describe how to download and install SUMO in Ubuntu 12.04 or 14.04.

**Step 1:** install the git package (if you have not done it before):

         sudo apt-get install git

**Step 2:** Create a directory on your computer (say VENTOS_SUMO on desktop). In terminal, navigate to this folder, and issue the following commnand to clone this repository into your computer:

         git clone https://github.com/ManiAm/VENTOS_SUMO

Note the `.gitignore` files (they are hidden) in different folders that prevent specific files (executable, object, etc) from being commited to the repository.

**Step 3:** Install these packages in Ubuntu

        sudo apt-get install libgdal1-dev proj libxerces-c2-dev libfox-1.6-dev libgl1-mesa-dev libglu1-mesa-dev

**Step 4:** Ubuntu 12.04 does not ship with `libgdal.so`, only with `libgdal1.7.0.so`. So, create a symbolic link:

        sudo ln -s /usr/lib/libgdal1.7.0.so /usr/lib/libgdal.so

**Step 5:** In the VENTOS_SUMO folder, you can see `configure.ac` and `Makefile.am` files. We should use `autoconf` to generate `configure` script from `configure.ac` file. Then from `makefile.am`, we should generate `makefile.in`, and then we should use `configure` script to generate `makefile`. `makefile` is the important file that is used for compilation. Look at the diagram below:
                                                                                                              
**configure.ac** (or configure.in) ---autoconf---> **configure** 

**makefile.am** ---automake---> **makefile.in** ---configure---> **makefile** ---make---> 
                                                                                                               
Fortunately, SUMO developers provide us with a `Makefile.cvs` file that eases the mentioned process. First, install these two packages:

        sudo apt-get install automake 1.11.1 autoconf 2.68

Then run the following command to generate `makefile.in` and `configure` script.

        sudo make -f Makefile.cvs

Note: It's ok if you receive these outputs (simply ignore them!):

        autoreconf -i
        libtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and
        libtoolize: rerunning libtoolize, to keep the correct libtool macros in-tree.
        libtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am.
        libtoolize: `AC_PROG_RANLIB' is rendered obsolete by `LT_INIT'

**Step 6:** Run the configure script, and resolve any errors that you might encounter:

        ./configure --enable-debug --with-proj-gdal --with-proj-libraries=/usr

Note that we used --enable-debug which disables level-2 compiler optimization (-O2) and is suitable for debugging purposes.

**Step 7:** compile and build the project:

        make

**Step 8:** Add the bin folder into `.bashrc` to be accessible from anywhere (You may use a different path depending on where you installed SUMO):

        PATH="$PATH:$HOME/Desktop/VENTOS_SUMO/bin"

You are done! Note that after every pull, you should make the project again.


For Developers
--------------

If you are a developer, and you are developing code for SUMO, then you can use an IDE like NetBeans. First we should create a new project in NetBeans, and then add the VENTOS_SUMO code into the project. Go to 'File | New Project | C/C++ | C/C++ Project with Existing Source'. Then click Browse and select the VENTOS_SUMO folder. In the 'Select Configuration Mode', click on Custom, and hit next. Then choose 'using makefile generated by configure script'. Change the 'Configure Argument' to this:

        --enable-debug --with-proj-gdal --with-proj-libraries=/usr

Click Next several times, and hit Finish at the end. Netbeans runs the `configure` script, and then `make clean` and then compiles the code. At the end of this step a `nbproject` folder will be created in the VENTOS_SUMO folder. If you check VENTOS_SUMO folder, you will see two main files:

1) sumo_main.cpp contains the main method for the command-line SUMO and

2) guisim_main.cpp contains the main method for gui SUMO.

A C++ program should only have one entry point, thus it needs only one main file! In this case that we have two seperate main files, you have to tell the IDE which one to use. In order to achieve this, you need to create two configurations (One for sumo and one for sumo_gui), and when you switch between configurations, the IDE knows which main file to choose.

To create a new configuration in NetBeans, click on the drop down menu and click customise. Then click on 'Manage Configurations' and click on new, and give it a name like sumoGUI. Now you have two configurations. Select sumoGUI and click run. IDE asks for an executable file. Select bin/sumo-guiD and click ok. Now the sumoGUI configuration is binded with bin/sumo-guiD and guisim_main.cpp will be used as the entry point.

Note: if you put a breakpoint on a line, but debugger did not stop on that line, try to delete the current configuration and make a new one.

